{"version":3,"names":["React","memo","useCallback","View","isEqual","Avatar","Bubble","SystemMessage","isSameUser","styles","Message","props","currentMessage","renderBubble","renderBubbleProp","renderSystemMessage","renderSystemMessageProp","onMessageLayout","nextMessage","position","containerStyle","user","showUserAvatar","onPressFile","onLongPressReaction","rest","createElement","_extends","renderAvatar","_currentMessage$user","_id","avatar","sameUser","onLayout","system","style","container","marginBottom","inverted","nextProps","_props$shouldUpdateMe","shouldUpdate","shouldUpdateMessage","call","previousMessage"],"sources":["index.tsx"],"sourcesContent":["/* eslint-disable react-native/no-inline-styles */\n/* eslint-disable @typescript-eslint/no-shadow */\nimport React, { memo, useCallback } from 'react';\nimport { View } from 'react-native';\nimport { isEqual } from 'lodash';\n\nimport { Avatar } from '../Avatar';\nimport Bubble from '../Bubble';\nimport { SystemMessage } from '../SystemMessage';\n\nimport { isSameUser } from '../utils';\nimport { type IMessage } from '../types';\nimport { type MessageProps } from './types';\nimport styles from './styles';\n\nexport * from './types';\n\nlet Message: React.FC<MessageProps<IMessage>> = (\n  props: MessageProps<IMessage>\n) => {\n  const {\n    currentMessage,\n    renderBubble: renderBubbleProp,\n    renderSystemMessage: renderSystemMessageProp,\n    onMessageLayout,\n    nextMessage,\n    position,\n    containerStyle,\n    user,\n    showUserAvatar,\n    onPressFile,\n    onLongPressReaction,\n  } = props;\n\n  const renderBubble = useCallback(() => {\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    const { containerStyle, onMessageLayout, ...rest } = props;\n\n    if (renderBubbleProp) return renderBubbleProp(rest);\n\n    return (\n      <Bubble\n        {...rest}\n        onPressFile={onPressFile}\n        onLongPressReaction={onLongPressReaction}\n      />\n    );\n  }, [props, renderBubbleProp, onPressFile, onLongPressReaction]);\n\n  const renderSystemMessage = useCallback(() => {\n    const {\n      /* eslint-disable @typescript-eslint/no-unused-vars */\n      containerStyle,\n      onMessageLayout,\n      /* eslint-enable @typescript-eslint/no-unused-vars */\n      ...rest\n    } = props;\n\n    if (renderSystemMessageProp) return renderSystemMessageProp(rest);\n\n    return <SystemMessage {...rest} />;\n  }, [props, renderSystemMessageProp]);\n\n  const renderAvatar = useCallback(() => {\n    if (\n      user?._id &&\n      currentMessage?.user &&\n      user._id === currentMessage.user._id &&\n      !showUserAvatar\n    )\n      return null;\n\n    if (currentMessage?.user?.avatar === null) return null;\n\n    const {\n      /* eslint-disable @typescript-eslint/no-unused-vars */\n      containerStyle,\n      onMessageLayout,\n      /* eslint-enable @typescript-eslint/no-unused-vars */\n      ...rest\n    } = props;\n\n    return <Avatar {...rest} />;\n  }, [props, user, currentMessage, showUserAvatar]);\n\n  if (!currentMessage) return null;\n\n  const sameUser = isSameUser(currentMessage, nextMessage!);\n\n  return (\n    <View onLayout={onMessageLayout}>\n      {currentMessage.system ? (\n        renderSystemMessage()\n      ) : (\n        <View\n          style={[\n            styles[position].container,\n            { marginBottom: sameUser ? 2 : 10 },\n            !props.inverted && { marginBottom: 2 },\n            containerStyle?.[position],\n          ]}\n        >\n          {position === 'left' ? renderAvatar() : null}\n          {renderBubble()}\n          {position === 'right' ? renderAvatar() : null}\n        </View>\n      )}\n    </View>\n  );\n};\n\nMessage = memo(Message, (props, nextProps) => {\n  const shouldUpdate =\n    props.shouldUpdateMessage?.(props, nextProps) ||\n    !isEqual(props.currentMessage!, nextProps.currentMessage!) ||\n    !isEqual(props.previousMessage, nextProps.previousMessage) ||\n    !isEqual(props.nextMessage, nextProps.nextMessage);\n\n  if (shouldUpdate) return false;\n\n  return true;\n});\n\nexport default Message;\n"],"mappings":"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","ignoreList":[]}