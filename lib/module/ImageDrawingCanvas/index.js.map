{"version":3,"names":["React","useCallback","useEffect","useMemo","useRef","useState","Alert","Animated","Dimensions","Image","Keyboard","PanResponder","Platform","ScrollView","Text","TextInput","TouchableOpacity","TouchableWithoutFeedback","View","styles","SafeAreaView","Canvas","Path","Skia","useImage","SkiaImage","useCanvasRef","Group","Rect","Circle","colors","ViewShot","IMG_WIDTH","get","width","IMG_HEIGHT","fontSize","ImageDrawingCanvas","props","visible","uriImage","onClose","onSave","titleCancel","contentCancel","txtBtnContinueCancel","txtBtnCancelCancel","txtBtnDone","txtBtnDoneEdit","canvasRef","image","textAnimationsRef","Map","viewShotRef","mode","setMode","paths","setPaths","history","setHistory","shapes","setShapes","currentPath","setCurrentPath","currentShape","setCurrentShape","shapeStartPos","setShapeStartPos","colorDraw","setColorDraw","showTextInput","setShowTextInput","currentInputText","setCurrentInputText","inputText","setInputText","editingTextId","setEditingTextId","editingTextValue","setEditingTextValue","colorText","setColorText","clipPath","path","Make","addRect","x","y","height","handleUndo","length","lastItem","type","prev","slice","handleDoneDraw","handleCapture","_viewShotRef$current","current","capture","uri","OS","error","console","createPanResponder","textId","textContent","textColor","hasMovedRef","create","onStartShouldSetPanResponder","onPanResponderGrant","panValue","setOffset","_value","setValue","onPanResponderMove","_","gestureState","Math","abs","dx","dy","event","useNativeDriver","onPanResponderRelease","flattenOffset","map","item","id","newId","Date","now","toString","text","color","set","ValueXY","pan","e","locationX","locationY","nativeEvent","p","moveTo","newPath","copy","lineTo","min","radius","sqrt","pow","newPaths","h","pathIndex","shapeToAdd","newShapes","shapeIndex","renderHeaderControls","hasDrawing","createElement","style","headerControls","btnClose","onPress","undefined","txtUndo","txtDone","justifyContent","dismiss","alert","clear","txtClose","layoutCanvas","btnCanvas","tintColor","source","require","imgCanvas","transform","rotate","txtCanvasMore","renderFooterControls","footerDraw","horizontal","showsHorizontalScrollIndicator","key","btnColor","padding","borderColor","colorDot","backgroundColor","borderWidth","btnDone","container","containerContent","flex","ref","options","format","quality","canvasContainer","_extends","panHandlers","clip","fit","pathWithColor","i","strokeWidth","shape","cx","cy","r","Fragment","opacity","element","has","panResponder","isEditing","movableBox","getTranslateTransform","textOverlay","value","onChangeText","selectionColor","autoFocus","multiline","onBlur","dimOverlay","pointerEvents","textInputOverlay","top","onFocus","footer"],"sources":["index.tsx"],"sourcesContent":["import React, {\n  useCallback,\n  useEffect,\n  useMemo,\n  useRef,\n  useState,\n} from 'react';\nimport {\n  Alert,\n  Animated,\n  Dimensions,\n  Image,\n  Keyboard,\n  PanResponder,\n  Platform,\n  ScrollView,\n  Text,\n  TextInput,\n  TouchableOpacity,\n  TouchableWithoutFeedback,\n  View,\n} from 'react-native';\nimport { styles } from './styles';\nimport { SafeAreaView } from 'react-native-safe-area-context';\nimport {\n  Canvas,\n  Path,\n  Skia,\n  useImage,\n  Image as SkiaImage,\n  useCanvasRef,\n  type SkPath,\n  Group,\n  Rect,\n  Circle,\n} from '@shopify/react-native-skia';\nimport {\n  colors,\n  type HistoryItem,\n  type IImageDrawingCanvas,\n  type IShapeStartPos,\n  type PathWithColor,\n  type Shape,\n  type TextItem,\n} from './types';\nimport ViewShot from 'react-native-view-shot';\n\nconst IMG_WIDTH = Dimensions.get('window').width;\nconst IMG_HEIGHT = Dimensions.get('window').width;\nconst fontSize = 22;\n\nconst ImageDrawingCanvas = (props: IImageDrawingCanvas) => {\n  const {\n    visible,\n    uriImage,\n    onClose,\n    onSave,\n    titleCancel = 'Huỷ bỏ chỉnh sửa',\n    contentCancel = 'Bạn có chắc muốn huỷ bỏ tất cả chỉnh sửa?',\n    txtBtnContinueCancel = 'Tiếp tục',\n    txtBtnCancelCancel = 'Huỷ bỏ',\n    txtBtnDone = 'Hoàn thành',\n    txtBtnDoneEdit = 'Xong',\n  } = props;\n\n  // Hooks phải được gọi trước early return\n  const canvasRef = useCanvasRef();\n  const image = useImage(uriImage);\n\n  // Lưu trữ Animated values cho mỗi text\n  const textAnimationsRef = useRef<Map<string, Animated.ValueXY>>(new Map());\n  const viewShotRef = useRef<ViewShot>(null);\n\n  const [mode, setMode] = useState<'draw' | 'text' | 'rect' | 'circle' | null>(\n    null\n  );\n  const [paths, setPaths] = useState<PathWithColor[]>([]);\n  const [history, setHistory] = useState<HistoryItem[]>([]);\n  const [shapes, setShapes] = useState<Shape[]>([]);\n  const [currentPath, setCurrentPath] = useState<SkPath | null>(null);\n  const [currentShape, setCurrentShape] = useState<Shape | null>(null);\n  const [shapeStartPos, setShapeStartPos] = useState<IShapeStartPos | null>(\n    null\n  );\n\n  const [colorDraw, setColorDraw] = useState<string>(colors[0] || '');\n\n  const [showTextInput, setShowTextInput] = useState(false);\n  const [currentInputText, setCurrentInputText] = useState<string>('');\n  const [inputText, setInputText] = useState<TextItem[]>([]);\n  const [editingTextId, setEditingTextId] = useState<string | null>(null);\n  const [editingTextValue, setEditingTextValue] = useState<string>('');\n  const [colorText, setColorText] = useState<string>(colors[0] || '');\n\n  const clipPath = useMemo(() => {\n    const path = Skia.Path.Make();\n    path.addRect({ x: 0, y: 0, width: IMG_WIDTH, height: IMG_HEIGHT });\n    return path;\n  }, []);\n\n  const handleUndo = useCallback(() => {\n    if (history.length === 0) return;\n\n    const lastItem = history[history.length - 1];\n\n    if (lastItem?.type === 'path') {\n      setPaths((prev) => prev.slice(0, -1));\n    } else if (lastItem?.type === 'shape') {\n      setShapes((prev) => prev.slice(0, -1));\n    }\n\n    setHistory((prev) => prev.slice(0, -1));\n  }, [history]);\n\n  const handleDoneDraw = useCallback(() => {\n    setMode(null);\n  }, []);\n\n  const handleCapture = useCallback(async () => {\n    try {\n      if (viewShotRef.current?.capture) {\n        const uri = await viewShotRef.current.capture();\n        // Có thể return uri này hoặc gọi callback\n        return Platform.OS === 'ios' ? `file://${uri}` : uri;\n      }\n      return null;\n    } catch (error) {\n      console.error('Error capturing image:', error);\n      return null;\n    }\n  }, []);\n\n  const createPanResponder = (\n    textId: string,\n    textContent: string,\n    textColor: string\n  ) => {\n    let hasMovedRef = false;\n\n    return PanResponder.create({\n      onStartShouldSetPanResponder: () => true,\n      onPanResponderGrant: () => {\n        hasMovedRef = false;\n        const panValue = textAnimationsRef.current.get(textId);\n        if (panValue) {\n          panValue.setOffset({\n            x: (panValue.x as any)._value,\n            y: (panValue.y as any)._value,\n          });\n          panValue.setValue({ x: 0, y: 0 });\n        }\n      },\n      onPanResponderMove: (_, gestureState) => {\n        // Nếu di chuyển quá 5px thì coi như đang kéo\n        if (Math.abs(gestureState.dx) > 5 || Math.abs(gestureState.dy) > 5) {\n          hasMovedRef = true;\n        }\n\n        const panValue = textAnimationsRef.current.get(textId);\n        if (panValue && hasMovedRef) {\n          Animated.event([null, { dx: panValue.x, dy: panValue.y }], {\n            useNativeDriver: false,\n          })(_, gestureState);\n        }\n      },\n      onPanResponderRelease: () => {\n        const panValue = textAnimationsRef.current.get(textId);\n\n        if (!hasMovedRef) {\n          // Nếu không có movement, đây là tap -> mở edit mode\n          setMode('text');\n          setEditingTextId(textId);\n          setEditingTextValue(textContent);\n          setColorText(textColor);\n          if (panValue) {\n            // Reset về vị trí cũ\n            panValue.setValue({ x: 0, y: 0 });\n            panValue.flattenOffset();\n          }\n        } else if (panValue) {\n          // Nếu có movement, lưu vị trí mới\n          panValue.flattenOffset();\n          setInputText((prev) =>\n            prev.map((item) =>\n              item.id === textId\n                ? {\n                    ...item,\n                    x: (panValue.x as any)._value,\n                    y: (panValue.y as any)._value,\n                  }\n                : item\n            )\n          );\n        }\n      },\n    });\n  };\n\n  useEffect(() => {\n    if (!showTextInput && currentInputText?.length > 0) {\n      const newId = Date.now().toString();\n      setCurrentInputText('');\n      setInputText((prev) => [\n        ...prev,\n        {\n          text: currentInputText,\n          id: newId,\n          x: -IMG_WIDTH / 2,\n          y: -IMG_HEIGHT / 2,\n          color: colorText,\n        },\n      ]);\n      // Tạo Animated value mới cho text này\n      textAnimationsRef.current.set(\n        newId,\n        new Animated.ValueXY({\n          x: -IMG_WIDTH / 2,\n          y: -IMG_HEIGHT / 2,\n        })\n      );\n    }\n  }, [currentInputText, showTextInput, colorText]);\n\n  const pan = useMemo(\n    () =>\n      PanResponder.create({\n        onStartShouldSetPanResponder: () => true,\n        onPanResponderGrant: (e) => {\n          const { locationX, locationY } = e.nativeEvent;\n\n          if (mode === 'draw') {\n            const p = Skia.Path.Make();\n            p.moveTo(locationX, locationY);\n            setCurrentPath(p);\n          } else if (mode === 'rect' || mode === 'circle') {\n            // Only set start position, wait for move to create shape\n            setShapeStartPos({ x: locationX, y: locationY });\n          }\n        },\n        onPanResponderMove: (e) => {\n          const { locationX, locationY } = e.nativeEvent;\n\n          if (mode === 'draw' && currentPath) {\n            const newPath = currentPath.copy();\n            newPath.lineTo(locationX, locationY);\n            setCurrentPath(newPath);\n          } else if ((mode === 'rect' || mode === 'circle') && shapeStartPos) {\n            if (mode === 'rect') {\n              setCurrentShape({\n                type: 'rect',\n                x: Math.min(shapeStartPos.x, locationX),\n                y: Math.min(shapeStartPos.y, locationY),\n                width: Math.abs(locationX - shapeStartPos.x),\n                height: Math.abs(locationY - shapeStartPos.y),\n              });\n            } else {\n              const radius = Math.sqrt(\n                Math.pow(locationX - shapeStartPos.x, 2) +\n                  Math.pow(locationY - shapeStartPos.y, 2)\n              );\n              setCurrentShape({\n                type: 'circle',\n                x: shapeStartPos.x,\n                y: shapeStartPos.y,\n                radius: radius,\n              });\n            }\n          }\n        },\n        onPanResponderRelease: () => {\n          if (mode === 'draw' && currentPath) {\n            setPaths((prev) => {\n              const newPaths = [\n                ...prev,\n                { path: currentPath, color: colorDraw },\n              ];\n              setHistory((h) => [\n                ...h,\n                { type: 'path', pathIndex: newPaths.length - 1 },\n              ]);\n              return newPaths;\n            });\n            setCurrentPath(null);\n          } else if ((mode === 'rect' || mode === 'circle') && currentShape) {\n            // Batch state updates to prevent UI flickering\n            const shapeToAdd = currentShape;\n            setCurrentShape(null);\n            setShapeStartPos(null);\n            setShapes((prev) => {\n              const newShapes = [...prev, shapeToAdd];\n              setHistory((h) => [\n                ...h,\n                { type: 'shape', shapeIndex: newShapes.length - 1 },\n              ]);\n              return newShapes;\n            });\n          }\n        },\n      }),\n    [mode, currentPath, currentShape, shapeStartPos, colorDraw]\n  );\n\n  const renderHeaderControls = useMemo(() => {\n    const hasDrawing =\n      paths?.length > 0 || shapes?.length > 0 || inputText?.length > 0;\n    if (mode === 'draw') {\n      return (\n        <View style={styles.headerControls}>\n          <TouchableOpacity\n            style={styles.btnClose}\n            onPress={paths?.length > 0 ? handleUndo : undefined}\n          >\n            {paths?.length > 0 && <Text style={styles.txtUndo}>Hoàn tác</Text>}\n          </TouchableOpacity>\n\n          <TouchableOpacity style={styles.btnClose} onPress={handleDoneDraw}>\n            <Text style={styles.txtDone}>{txtBtnDoneEdit}</Text>\n          </TouchableOpacity>\n        </View>\n      );\n    }\n    if (mode === 'text') {\n      return (\n        <View style={[styles.headerControls, { justifyContent: 'flex-end' }]}>\n          <TouchableOpacity\n            style={styles.btnClose}\n            onPress={() => {\n              handleDoneDraw();\n              Keyboard.dismiss();\n            }}\n          >\n            <Text style={styles.txtDone}>{txtBtnDoneEdit}</Text>\n          </TouchableOpacity>\n        </View>\n      );\n    }\n    return (\n      <View style={styles.headerControls}>\n        <TouchableOpacity\n          style={styles.btnClose}\n          onPress={() => {\n            if (hasDrawing) {\n              Alert.alert(titleCancel, contentCancel, [\n                {\n                  text: txtBtnContinueCancel,\n                  style: 'cancel',\n                },\n                {\n                  text: txtBtnCancelCancel,\n                  style: 'destructive',\n                  onPress: () => {\n                    onClose();\n                    setPaths([]);\n                    setCurrentPath(null);\n                    setShapes([]);\n                    setCurrentShape(null);\n                    setShapeStartPos(null);\n                    setColorDraw(colors[0] || '');\n                    setInputText([]);\n                    setHistory([]);\n                    // Xóa tất cả animations\n                    textAnimationsRef.current.clear();\n                  },\n                },\n              ]);\n            } else {\n              onClose();\n              setPaths([]);\n              setCurrentPath(null);\n              setShapes([]);\n              setCurrentShape(null);\n              setShapeStartPos(null);\n              setColorDraw(colors[0] || '');\n              setInputText([]);\n              setHistory([]);\n              // Xóa tất cả animations\n              textAnimationsRef.current.clear();\n            }\n          }}\n        >\n          <Text style={styles.txtClose}>X</Text>\n        </TouchableOpacity>\n\n        <View style={styles.layoutCanvas}>\n          <TouchableOpacity\n            onPress={() => {\n              setMode('draw');\n              setShowTextInput(false);\n            }}\n            style={styles.btnCanvas}\n          >\n            <Image\n              tintColor={'white'}\n              source={require('./assets/line.png')}\n              style={[styles.imgCanvas, { transform: [{ rotate: '45deg' }] }]}\n            />\n          </TouchableOpacity>\n          <TouchableOpacity\n            onPress={() => {\n              setMode('text');\n              setShowTextInput(true);\n              setColorText(colors[0] || '');\n            }}\n            style={styles.btnCanvas}\n          >\n            <Text style={styles.txtCanvasMore}>Aa</Text>\n          </TouchableOpacity>\n          {/* <TouchableOpacity style={styles.btnCanvas}>\n            <Image\n              tintColor={'white'}\n              source={require('./assets/crop.png')}\n              style={styles.imgCanvas}\n            />\n          </TouchableOpacity> */}\n          {/* <TouchableOpacity\n            style={styles.btnCanvas}\n            onPress={async () => {\n              const uri = await handleCapture();\n              if (uri && onSave) {\n                onSave(uri);\n              }\n            }}\n          >\n            <Image\n              tintColor={'white'}\n              source={require('./assets/download.png')}\n              style={styles.imgCanvas}\n            />\n          </TouchableOpacity> */}\n        </View>\n      </View>\n    );\n  }, [\n    paths?.length,\n    shapes?.length,\n    inputText?.length,\n    mode,\n    handleUndo,\n    handleDoneDraw,\n    txtBtnDoneEdit,\n    titleCancel,\n    contentCancel,\n    txtBtnContinueCancel,\n    txtBtnCancelCancel,\n    onClose,\n  ]);\n\n  const renderFooterControls = useMemo(() => {\n    if (mode === 'draw') {\n      return (\n        <View style={styles.footerDraw}>\n          {/* <TouchableOpacity style={[styles.btnEaser]}>\n            <Image\n              tintColor={'white'}\n              source={require('./assets/eraser_white.png')}\n              style={styles.btnEaserImage}\n            />\n          </TouchableOpacity> */}\n\n          <ScrollView horizontal showsHorizontalScrollIndicator={false}>\n            {colors.map((color) => (\n              <TouchableOpacity\n                onPress={() => {\n                  setColorDraw(color);\n                }}\n                key={color}\n                style={[\n                  styles.btnColor,\n                  colorDraw === color && { padding: 2, borderColor: 'white' },\n                ]}\n              >\n                <View\n                  style={[\n                    styles.colorDot,\n                    { backgroundColor: color },\n                    colorDraw === color && { borderWidth: 0 },\n                  ]}\n                />\n              </TouchableOpacity>\n            ))}\n          </ScrollView>\n        </View>\n      );\n    }\n\n    if (mode === 'text') {\n      return (\n        <View style={styles.footerDraw}>\n          <ScrollView horizontal showsHorizontalScrollIndicator={false}>\n            {colors.map((color) => (\n              <TouchableOpacity\n                onPress={() => {\n                  setColorText(color);\n                }}\n                key={color}\n                style={[\n                  styles.btnColor,\n                  colorText === color && { padding: 2, borderColor: 'white' },\n                ]}\n              >\n                <View\n                  style={[\n                    styles.colorDot,\n                    { backgroundColor: color },\n                    colorText === color && { borderWidth: 0 },\n                  ]}\n                />\n              </TouchableOpacity>\n            ))}\n          </ScrollView>\n        </View>\n      );\n    }\n    const hasDrawing =\n      paths?.length > 0 || shapes?.length > 0 || inputText?.length > 0;\n    return (\n      <View style={styles.footerDraw}>\n        {hasDrawing && (\n          <TouchableOpacity\n            style={styles.btnDone}\n            onPress={async () => {\n              const uri = await handleCapture();\n              if (uri && onSave) {\n                onSave(uri);\n              }\n\n              handleDoneDraw();\n              onClose();\n              setPaths([]);\n              setCurrentPath(null);\n              setShapes([]);\n              setCurrentShape(null);\n              setShapeStartPos(null);\n              setColorDraw(colors[0] || '');\n              setInputText([]);\n              setHistory([]);\n              // Xóa tất cả animations\n              textAnimationsRef.current.clear();\n            }}\n          >\n            <Text style={[styles.txtDone, { color: 'black' }]}>\n              {txtBtnDone}\n            </Text>\n          </TouchableOpacity>\n        )}\n      </View>\n    );\n  }, [\n    mode,\n    txtBtnDone,\n    colorDraw,\n    colorText,\n    paths.length,\n    shapes.length,\n    inputText.length,\n    handleDoneDraw,\n    onClose,\n    handleCapture,\n    onSave,\n  ]);\n\n  if (!visible) {\n    return null;\n  }\n\n  return (\n    <SafeAreaView style={styles.container}>\n      <TouchableWithoutFeedback\n        onPress={() => {\n          Keyboard.dismiss();\n          handleDoneDraw();\n        }}\n      >\n        <View style={styles.containerContent}>\n          {renderHeaderControls}\n\n          <ViewShot\n            style={{ flex: 1 }}\n            ref={viewShotRef}\n            options={{\n              format: 'jpg',\n              quality: 0.9,\n            }}\n          >\n            <View style={styles.canvasContainer}>\n              <Canvas\n                ref={canvasRef as any}\n                style={{ width: IMG_WIDTH, height: IMG_HEIGHT }}\n                {...pan.panHandlers}\n              >\n                <Group clip={clipPath}>\n                  {/* Image nền */}\n                  {image && (\n                    <SkiaImage\n                      image={image}\n                      x={0}\n                      y={0}\n                      width={IMG_WIDTH}\n                      height={IMG_HEIGHT}\n                      fit=\"cover\"\n                    />\n                  )}\n\n                  {/* Nét vẽ */}\n                  {paths.map((pathWithColor, i) => (\n                    <Path\n                      key={`path-${i}`}\n                      path={pathWithColor.path}\n                      color={pathWithColor.color}\n                      style=\"stroke\"\n                      strokeWidth={4}\n                    />\n                  ))}\n                  {currentPath && (\n                    <Path\n                      path={currentPath}\n                      color={colorDraw}\n                      style=\"stroke\"\n                      strokeWidth={4}\n                    />\n                  )}\n\n                  {/* Hình vẽ */}\n                  {shapes.map((shape, i) => {\n                    if (shape.type === 'rect' && shape.width && shape.height) {\n                      return (\n                        <Rect\n                          key={`rect-${i}`}\n                          x={shape.x}\n                          y={shape.y}\n                          width={shape.width}\n                          height={shape.height}\n                          color=\"green\"\n                          style=\"stroke\"\n                          strokeWidth={3}\n                        />\n                      );\n                    }\n                    if (shape.type === 'circle' && shape.radius) {\n                      return (\n                        <Circle\n                          key={`circle-${i}`}\n                          cx={shape.x}\n                          cy={shape.y}\n                          r={shape.radius}\n                          color=\"blue\"\n                          style=\"stroke\"\n                          strokeWidth={3}\n                        />\n                      );\n                    }\n                    return <React.Fragment key={`empty-${i}`} />;\n                  })}\n\n                  {/* Hình đang kéo */}\n                  {currentShape?.type === 'rect' &&\n                    currentShape.width &&\n                    currentShape.height && (\n                      <Rect\n                        x={currentShape.x}\n                        y={currentShape.y}\n                        width={currentShape.width}\n                        height={currentShape.height}\n                        color=\"green\"\n                        style=\"stroke\"\n                        strokeWidth={3}\n                        opacity={1}\n                      />\n                    )}\n                  {currentShape?.type === 'circle' && currentShape.radius && (\n                    <Circle\n                      cx={currentShape.x}\n                      cy={currentShape.y}\n                      r={currentShape.radius}\n                      color=\"blue\"\n                      style=\"stroke\"\n                      strokeWidth={3}\n                      opacity={1}\n                    />\n                  )}\n                </Group>\n              </Canvas>\n\n              {(mode === 'text' || inputText.length > 0) && (\n                <View>\n                  {inputText?.map((element) => {\n                    // Lấy hoặc tạo animation value cho text này\n                    if (!textAnimationsRef.current.has(element.id)) {\n                      textAnimationsRef.current.set(\n                        element.id,\n                        new Animated.ValueXY({ x: element.x, y: element.y })\n                      );\n                    }\n                    const panValue = textAnimationsRef.current.get(element.id);\n                    const panResponder = createPanResponder(\n                      element.id,\n                      element.text,\n                      element.color\n                    );\n                    const isEditing = editingTextId === element.id;\n\n                    return (\n                      <Animated.View\n                        key={element.id}\n                        {...(!isEditing ? panResponder.panHandlers : {})}\n                        style={[\n                          styles.movableBox,\n                          {\n                            transform: panValue?.getTranslateTransform() ?? [],\n                          },\n                        ]}\n                      >\n                        {isEditing ? (\n                          <TextInput\n                            style={[\n                              styles.textOverlay,\n                              { color: colorText, fontSize },\n                            ]}\n                            value={editingTextValue}\n                            onChangeText={setEditingTextValue}\n                            selectionColor={colorText}\n                            autoFocus\n                            multiline\n                            onBlur={() => {\n                              // Lưu text và màu mới khi mất focus\n                              setInputText((prev) =>\n                                prev.map((item) =>\n                                  item.id === element.id\n                                    ? {\n                                        ...item,\n                                        text: editingTextValue,\n                                        color: colorText,\n                                      }\n                                    : item\n                                )\n                              );\n                              setMode(null);\n                              setEditingTextId(null);\n                              setEditingTextValue('');\n                            }}\n                          />\n                        ) : (\n                          <Text\n                            style={[\n                              styles.textOverlay,\n                              { color: element.color, fontSize },\n                            ]}\n                          >\n                            {element.text}\n                          </Text>\n                        )}\n                      </Animated.View>\n                    );\n                  })}\n                </View>\n              )}\n\n              {showTextInput && (\n                <>\n                  <View style={styles.dimOverlay} pointerEvents=\"none\" />\n                  <TextInput\n                    key={colorText}\n                    style={[\n                      styles.textInputOverlay,\n                      {\n                        fontSize,\n                        top: IMG_HEIGHT / 2,\n                        color: colorText,\n                      },\n                    ]}\n                    value={currentInputText}\n                    onChangeText={setCurrentInputText}\n                    selectionColor={colorText}\n                    autoFocus\n                    onFocus={() => setShowTextInput(true)}\n                    onBlur={() => setShowTextInput(false)}\n                    multiline\n                  />\n                </>\n              )}\n            </View>\n          </ViewShot>\n\n          <View style={styles.footer}>{renderFooterControls}</View>\n        </View>\n      </TouchableWithoutFeedback>\n    </SafeAreaView>\n  );\n};\n\nexport default ImageDrawingCanvas;\n"],"mappings":"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","ignoreList":[]}