{"version":3,"names":["PropTypes","React","PureComponent","Animated","Easing","Indicator","constructor","props","_defineProperty","animationState","savedValue","animating","state","progress","Value","hideAnimation","componentDidMount","startAnimation","componentDidUpdate","prevProps","resumeAnimation","stopAnimation","hideAnimationDuration","duration","timing","toValue","useNativeDriver","start","interaction","animationEasing","animationDuration","animation","easing","isInteraction","loop","listener","addListener","value","removeListener","saveAnimation","finished","setValue","renderComponent","_item","index","count","render","hidesWhenStopped","style","Array","isArray","opacity","filter","Boolean","createElement","View","from","linear","func","number","bool"],"sources":["index.ts"],"sourcesContent":["import PropTypes from 'prop-types';\r\nimport React, { PureComponent } from 'react';\r\nimport { Animated, Easing } from 'react-native';\r\n\r\nexport default class Indicator extends PureComponent {\r\n  static defaultProps = {\r\n    animationEasing: Easing.linear,\r\n    animationDuration: 1200,\r\n    hideAnimationDuration: 200,\r\n\r\n    animating: true,\r\n    interaction: true,\r\n    hidesWhenStopped: true,\r\n\r\n    count: 1,\r\n  };\r\n\r\n  static propTypes = {\r\n    animationEasing: PropTypes.func,\r\n    animationDuration: PropTypes.number,\r\n    hideAnimationDuration: PropTypes.number,\r\n\r\n    animating: PropTypes.bool,\r\n    interaction: PropTypes.bool,\r\n    hidesWhenStopped: PropTypes.bool,\r\n\r\n    renderComponent: PropTypes.func,\r\n    count: PropTypes.number,\r\n  };\r\n  animationState: number;\r\n  savedValue: number;\r\n\r\n  constructor(props: any) {\r\n    super(props);\r\n\r\n    /*\r\n     *  0 -> 1\r\n     *    | startAnimation\r\n     *    | resumeAnimation\r\n     *\r\n     *  1 -> -1\r\n     *    | stopAnimation\r\n     *\r\n     * -1 -> 0\r\n     *    | saveAnimation\r\n     */\r\n    this.animationState = 0;\r\n    this.savedValue = 0;\r\n\r\n    let { animating }: any = this.props;\r\n\r\n    this.state = {\r\n      progress: new Animated.Value(0),\r\n      hideAnimation: new Animated.Value(animating ? 1 : 0),\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n    let { animating }: any = this.props;\r\n\r\n    if (animating) {\r\n      this.startAnimation();\r\n    }\r\n  }\r\n\r\n  componentDidUpdate(prevProps: any) {\r\n    let { animating }: any = this.props;\r\n\r\n    if (animating && !prevProps.animating) {\r\n      this.resumeAnimation();\r\n    }\r\n\r\n    if (!animating && prevProps.animating) {\r\n      this.stopAnimation();\r\n    }\r\n\r\n    if (animating ^ prevProps.animating) {\r\n      let { hideAnimation }: any = this.state;\r\n      let { hideAnimationDuration: duration }: any = this.props;\r\n\r\n      Animated.timing(hideAnimation, {\r\n        toValue: animating ? 1 : 0,\r\n        duration,\r\n        useNativeDriver: false,\r\n      }).start() as any;\r\n    }\r\n  }\r\n\r\n  startAnimation() {\r\n    let { progress }: any = this.state;\r\n    let { interaction, animationEasing, animationDuration }: any = this.props;\r\n\r\n    if (0 !== this.animationState) {\r\n      return;\r\n    }\r\n\r\n    let animation = Animated.timing(progress, {\r\n      duration: animationDuration,\r\n      easing: animationEasing,\r\n      useNativeDriver: true,\r\n      isInteraction: interaction,\r\n      toValue: 1,\r\n    });\r\n\r\n    Animated.loop(animation).start() as any;\r\n\r\n    this.animationState = 1;\r\n  }\r\n\r\n  stopAnimation() {\r\n    let { progress }: any = this.state;\r\n\r\n    if (1 !== this.animationState) {\r\n      return;\r\n    }\r\n\r\n    let listener = progress.addListener(({ value }: any) => {\r\n      progress.removeListener(listener);\r\n      progress.stopAnimation(() => this.saveAnimation(value));\r\n    });\r\n\r\n    this.animationState = -1;\r\n  }\r\n\r\n  saveAnimation(value: number) {\r\n    let { animating }: any = this.props;\r\n\r\n    this.savedValue = value;\r\n    this.animationState = 0;\r\n\r\n    if (animating) {\r\n      this.resumeAnimation();\r\n    }\r\n  }\r\n\r\n  resumeAnimation() {\r\n    let { progress }: any = this.state;\r\n    let { interaction, animationDuration }: any = this.props;\r\n\r\n    if (0 !== this.animationState) {\r\n      return;\r\n    }\r\n\r\n    Animated.timing(progress, {\r\n      useNativeDriver: true,\r\n      isInteraction: interaction,\r\n      duration: (1 - this.savedValue) * animationDuration,\r\n      toValue: 1,\r\n    }).start(({ finished }) => {\r\n      if (finished) {\r\n        progress.setValue(0);\r\n\r\n        this.animationState = 0;\r\n        this.startAnimation();\r\n      }\r\n    });\r\n\r\n    this.savedValue = 0;\r\n    this.animationState = 1;\r\n  }\r\n\r\n  renderComponent(_item: any, index: number) {\r\n    let { progress }: any = this.state;\r\n    let { renderComponent, count }: any = this.props;\r\n\r\n    if ('function' === typeof renderComponent) {\r\n      return renderComponent({ index, count, progress });\r\n    }\r\n\r\n    return null;\r\n  }\r\n\r\n  render() {\r\n    let { hideAnimation }: any = this.state;\r\n    let { count, hidesWhenStopped, ...props }: any = this.props;\r\n\r\n    if (hidesWhenStopped) {\r\n      props.style = [\r\n        ...(Array.isArray(props.style) ? props.style : [props.style]),\r\n        { opacity: hideAnimation },\r\n      ].filter(Boolean);\r\n    }\r\n    return React.createElement(\r\n      Animated.View,\r\n      props,\r\n      Array.from(new Array(count), this.renderComponent, this)\r\n    );\r\n  }\r\n}\r\n"],"mappings":"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","ignoreList":[]}