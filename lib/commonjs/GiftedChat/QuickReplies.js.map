{"version":3,"names":["_react","_interopRequireWildcard","require","_reactNative","_Color","_interopRequireDefault","_logging","_styles","e","__esModule","default","t","WeakMap","r","n","o","i","f","__proto__","has","get","set","hasOwnProperty","call","Object","defineProperty","getOwnPropertyDescriptor","styles","StyleSheet","create","container","flexDirection","flexWrap","maxWidth","quickReply","borderWidth","paddingVertical","paddingHorizontal","minHeight","borderRadius","margin","quickReplyText","overflow","sendLink","sendLinkText","color","Color","defaultBlue","fontWeight","fontSize","sameReply","currentReply","reply","value","diffReply","QuickReplies","currentMessage","nextMessage","peterRiver","quickReplyStyle","quickReplyTextStyle","quickReplyContainerStyle","onQuickReply","sendText","renderQuickReplySend","type","quickReplies","replies","setReplies","useState","shouldComponentDisplay","useMemo","hasReplies","hasNext","_id","keepIt","handleSend","useCallback","repliesData","map","messageId","handlePress","find","filter","warning","createElement","View","style","values","index","selected","TouchableOpacity","onPress","stylesCommon","centerItems","borderColor","backgroundColor","key","Text","numberOfLines","ellipsizeMode","white","title","length"],"sources":["QuickReplies.tsx"],"sourcesContent":["import React, { useState, useMemo, useCallback } from 'react';\nimport {\n  Text,\n  StyleSheet,\n  View,\n  TouchableOpacity,\n  type StyleProp,\n  type ViewStyle,\n  type TextStyle,\n} from 'react-native';\nimport { type IMessage, type Reply } from './types';\nimport Color from './Color';\nimport { warning } from './logging';\nimport stylesCommon from './styles';\n\nconst styles = StyleSheet.create({\n  container: {\n    flexDirection: 'row',\n    flexWrap: 'wrap',\n    maxWidth: 300,\n  },\n  quickReply: {\n    borderWidth: 1,\n    maxWidth: 200,\n    paddingVertical: 7,\n    paddingHorizontal: 12,\n    minHeight: 50,\n    borderRadius: 13,\n    margin: 3,\n  },\n  quickReplyText: {\n    overflow: 'visible',\n  },\n  sendLink: {\n    borderWidth: 0,\n  },\n  sendLinkText: {\n    color: Color.defaultBlue,\n    fontWeight: '600',\n    fontSize: 17,\n  },\n});\n\nexport interface QuickRepliesProps<TMessage extends IMessage = IMessage> {\n  nextMessage?: TMessage;\n  currentMessage: TMessage;\n  color?: string;\n  sendText?: string;\n  quickReplyStyle?: StyleProp<ViewStyle>;\n  quickReplyTextStyle?: StyleProp<TextStyle>;\n  quickReplyContainerStyle?: StyleProp<ViewStyle>;\n  onQuickReply?(reply: Reply[]): void;\n  renderQuickReplySend?(): React.ReactNode;\n}\n\nconst sameReply = (currentReply: Reply) => (reply: Reply) =>\n  currentReply.value === reply.value;\n\nconst diffReply = (currentReply: Reply) => (reply: Reply) =>\n  currentReply.value !== reply.value;\n\nexport function QuickReplies({\n  currentMessage,\n  nextMessage,\n  color = Color.peterRiver,\n  quickReplyStyle,\n  quickReplyTextStyle,\n  quickReplyContainerStyle,\n  onQuickReply,\n  sendText = 'Send',\n  renderQuickReplySend,\n}: QuickRepliesProps<IMessage>) {\n  const { type } = currentMessage!.quickReplies!;\n  const [replies, setReplies] = useState<Reply[]>([]);\n\n  const shouldComponentDisplay = useMemo(() => {\n    const hasReplies = !!currentMessage && !!currentMessage!.quickReplies;\n    const hasNext = !!nextMessage && !!nextMessage!._id;\n    const keepIt = currentMessage!.quickReplies!.keepIt;\n\n    if (hasReplies && !hasNext) return true;\n\n    if (hasReplies && hasNext && keepIt) return true;\n\n    return false;\n  }, [currentMessage, nextMessage]);\n\n  const handleSend = useCallback(\n    (repliesData: Reply[]) => () => {\n      onQuickReply?.(\n        repliesData.map((reply: Reply) => ({\n          ...reply,\n          messageId: currentMessage!._id,\n        }))\n      );\n    },\n    [onQuickReply, currentMessage]\n  );\n\n  const handlePress = useCallback(\n    (reply: Reply) => () => {\n      if (currentMessage) {\n        const { type } = currentMessage.quickReplies!;\n        switch (type) {\n          case 'radio': {\n            handleSend([reply])();\n            return;\n          }\n          case 'checkbox': {\n            if (replies.find(sameReply(reply)))\n              setReplies(replies.filter(diffReply(reply)));\n            else setReplies([...replies, reply]);\n\n            return;\n          }\n          default: {\n            warning(`onQuickReply unknown type: ${type}`);\n          }\n        }\n      }\n    },\n    [replies, currentMessage, handleSend]\n  );\n\n  if (!shouldComponentDisplay) return null;\n\n  return (\n    <View style={[styles.container, quickReplyContainerStyle]}>\n      {currentMessage!.quickReplies!.values.map(\n        (reply: Reply, index: number) => {\n          const selected =\n            type === 'checkbox' && replies.find(sameReply(reply));\n\n          return (\n            <TouchableOpacity\n              onPress={handlePress(reply)}\n              style={[\n                stylesCommon.centerItems,\n                styles.quickReply,\n                quickReplyStyle,\n                { borderColor: color },\n                selected && { backgroundColor: color },\n              ]}\n              key={`${reply.value}-${index}`}\n            >\n              <Text\n                numberOfLines={10}\n                ellipsizeMode=\"tail\"\n                style={[\n                  styles.quickReplyText,\n                  { color: selected ? Color.white : color },\n                  quickReplyTextStyle,\n                ]}\n              >\n                {reply.title}\n              </Text>\n            </TouchableOpacity>\n          );\n        }\n      )}\n      {replies.length > 0 && (\n        <TouchableOpacity\n          style={[stylesCommon.centerItems, styles.quickReply, styles.sendLink]}\n          onPress={handleSend(replies)}\n        >\n          {renderQuickReplySend?.() || (\n            <Text style={styles.sendLinkText}>{sendText}</Text>\n          )}\n        </TouchableOpacity>\n      )}\n    </View>\n  );\n}\n"],"mappings":"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","ignoreList":[]}