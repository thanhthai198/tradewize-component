{"version":3,"names":["_react","_interopRequireWildcard","require","_reactNative","_utils","_reactNativeFastImage","_interopRequireDefault","_Color","_reactNativeCircularProgress","_utils2","_ButtonBase","e","__esModule","default","t","WeakMap","r","n","o","i","f","__proto__","has","get","set","hasOwnProperty","call","Object","defineProperty","getOwnPropertyDescriptor","GAP_MEDIA","calcSize","isShowAll","messageWidth","width","Number","getScreenWidth","sizeMedia","sizeMediaShowAll","MediaItem","memo","item","index","size","arrMedia","isReaction","currentMessage","onPressFile","onLongPressFile","progressNum","progress","safeProgress","isFinite","Math","max","min","createElement","Fragment","ButtonBase","onLongPress","onPress","length","file","disabled","isLoading","typeFile","style","styles","mediaItem","height","thumbnailPreview","uri","url","source","priority","FastImage","low","image","View","playIcon","borderRadius","ActivityIndicator","color","Color","defaultBlue","resizeMode","cover","reactionIcon","Text","reactionIconText","AnimatedCircularProgress","fill","tintColor","white","backgroundColor","defaultColor","prev","next","MessageFile","onLayout","onSaveThumbnail","setArrMedia","useState","thumbnailCache","useRef","Map","processedFiles","Set","useEffect","fetchData","getFileComplete","filter","videosNeedThumbnail","current","newArrMediaLoading","map","isProcessing","some","v","result","generateThumbnails","forEach","res","video","path","add","newArrMedia","cachedThumbnail","thumbnail","error","console","log","arrMediaShow","slice","container","gap","FlatList","data","renderItem","keyExtractor","_item$clientId","_item$uri","clientId","toString","numColumns","scrollEnabled","columnWrapperStyle","initialNumToRender","maxToRenderPerBatch","windowSize","removeClippedSubviews","getItemLayout","_","offset","floor","StyleSheet","create","flexDirection","marginVertical","paddingHorizontal","overflow","alignItems","justifyContent","marginBottom","position","fontSize","fontWeight","lineHeight","top","left"],"sources":["MessageFile.tsx"],"sourcesContent":["import React, { useEffect, useState, memo, useRef } from 'react';\r\nimport {\r\n  ActivityIndicator,\r\n  FlatList,\r\n  StyleSheet,\r\n  Text,\r\n  View,\r\n  type LayoutChangeEvent,\r\n} from 'react-native';\r\nimport type { FileMessage, IMessage } from './types';\r\nimport { generateThumbnails } from './utils';\r\nimport FastImage from 'react-native-fast-image';\r\nimport Color from './Color';\r\nimport { AnimatedCircularProgress } from 'react-native-circular-progress';\r\nimport { getScreenWidth } from '../utils';\r\nimport { ButtonBase } from '../ButtonBase';\r\n\r\nconst GAP_MEDIA = 3;\r\n\r\ninterface MessageFileProps {\r\n  onPressFile?: (\r\n    file: FileMessage,\r\n    isShowAll?: boolean,\r\n    arrMedia?: IMessage\r\n  ) => void;\r\n  messageWidth?: { width: number; _id: string } | null;\r\n  currentMessage: IMessage;\r\n  isReaction?: boolean;\r\n  onLayout?: (event: LayoutChangeEvent) => void;\r\n  onSaveThumbnail?: (file: FileMessage[]) => void;\r\n  isShowAll?: boolean;\r\n  onLongPressFile?: () => void;\r\n}\r\n\r\n// ✅ tính toán size cố định dựa vào messageWidth + isShowAll\r\nconst calcSize = (\r\n  isShowAll: boolean | undefined,\r\n  messageWidth?: { width: number } | null\r\n) => {\r\n  const width = Number(messageWidth?.width) || getScreenWidth(); // fallback an toàn\r\n\r\n  const sizeMedia = width / 4.65 - GAP_MEDIA * 3.65;\r\n  const sizeMediaShowAll = width / 4 - GAP_MEDIA * 3;\r\n\r\n  if (isShowAll) return sizeMediaShowAll;\r\n  if (sizeMedia < getScreenWidth() * 0.1) return getScreenWidth() * 0.15;\r\n  return sizeMedia;\r\n};\r\n\r\ninterface MediaItemProps {\r\n  item: FileMessage;\r\n  index: number;\r\n  size: number;\r\n  arrMedia: FileMessage[];\r\n  isShowAll?: boolean;\r\n  isReaction?: boolean;\r\n  currentMessage: IMessage;\r\n  onPressFile?: (\r\n    file: FileMessage,\r\n    isShowAll?: boolean,\r\n    arrMedia?: IMessage\r\n  ) => void;\r\n  onLongPressFile?: () => void;\r\n}\r\n\r\n// ✅ MediaItem chỉ nhận size từ ngoài → ổn định layout\r\nconst MediaItem = memo(\r\n  ({\r\n    item,\r\n    index,\r\n    size,\r\n    arrMedia,\r\n    isShowAll,\r\n    isReaction,\r\n    currentMessage,\r\n    onPressFile,\r\n    onLongPressFile,\r\n  }: MediaItemProps) => {\r\n    const progressNum = Number(item?.progress);\r\n    const safeProgress = Number.isFinite(progressNum)\r\n      ? Math.max(0, Math.min(100, progressNum))\r\n      : 0;\r\n\r\n    return (\r\n      <>\r\n        <ButtonBase\r\n          onLongPress={onLongPressFile}\r\n          onPress={() =>\r\n            onPressFile?.(item, arrMedia?.length > 8 && index === 7, {\r\n              ...currentMessage,\r\n              file: arrMedia,\r\n            })\r\n          }\r\n          disabled={\r\n            isReaction || (item?.isLoading && item?.typeFile === 'video')\r\n          }\r\n          style={[\r\n            styles.mediaItem,\r\n            {\r\n              width: size,\r\n              height: size,\r\n            },\r\n          ]}\r\n        >\r\n          {(item?.thumbnailPreview || item?.uri || item?.url) && (\r\n            <FastImage\r\n              source={{\r\n                uri: item?.thumbnailPreview || item?.uri || item?.url,\r\n                priority: FastImage.priority.low,\r\n              }}\r\n              style={styles.image}\r\n            />\r\n          )}\r\n\r\n          {item?.typeFile === 'video' && (\r\n            <View\r\n              style={[\r\n                styles.playIcon,\r\n                (safeProgress <= 0 ||\r\n                  safeProgress >= 100 ||\r\n                  item?.isLoading) && {\r\n                  width: size * 0.5,\r\n                  height: size * 0.5,\r\n                  borderRadius: (size * 0.5) / 2,\r\n                },\r\n              ]}\r\n            >\r\n              {item?.isLoading ? (\r\n                <ActivityIndicator size=\"small\" color={Color.defaultBlue} />\r\n              ) : (\r\n                (safeProgress <= 0 || safeProgress >= 100) && (\r\n                  <FastImage\r\n                    source={require('./assets/play.png')}\r\n                    resizeMode={FastImage.resizeMode.cover}\r\n                    style={{\r\n                      width: (size * 0.5) / 2,\r\n                      height: (size * 0.5) / 2,\r\n                    }}\r\n                  />\r\n                )\r\n              )}\r\n            </View>\r\n          )}\r\n\r\n          {arrMedia?.length > 8 && index === 7 && !isShowAll && (\r\n            <View style={styles.reactionIcon}>\r\n              <Text style={styles.reactionIconText}>\r\n                + {arrMedia?.length - 8 > 99 ? '99+' : arrMedia?.length - 8}\r\n              </Text>\r\n            </View>\r\n          )}\r\n        </ButtonBase>\r\n\r\n        {!item?.isLoading && safeProgress > 0 && safeProgress < 100 && (\r\n          <View style={[styles.progress, { width: size, height: size }]}>\r\n            <AnimatedCircularProgress\r\n              size={size * 0.3}\r\n              width={3}\r\n              fill={safeProgress}\r\n              tintColor={Color.white}\r\n              backgroundColor={Color.defaultColor}\r\n            />\r\n          </View>\r\n        )}\r\n      </>\r\n    );\r\n  },\r\n  (prev, next) =>\r\n    prev.item.uri === next.item.uri &&\r\n    prev.item.thumbnailPreview === next.item.thumbnailPreview &&\r\n    prev.item.progress === next.item.progress &&\r\n    prev.item.isLoading === next.item.isLoading &&\r\n    prev.size === next.size // ✅ so sánh luôn size\r\n);\r\n\r\nexport function MessageFile({\r\n  onPressFile,\r\n  messageWidth,\r\n  currentMessage,\r\n  isReaction,\r\n  onLayout,\r\n  onSaveThumbnail,\r\n  isShowAll,\r\n  onLongPressFile,\r\n}: MessageFileProps) {\r\n  const [arrMedia, setArrMedia] = useState<FileMessage[]>(\r\n    currentMessage?.file || []\r\n  );\r\n\r\n  // ✅ Cache để tránh tạo lại thumbnail\r\n  const thumbnailCache = useRef<Map<string, string>>(new Map());\r\n  const processedFiles = useRef<Set<string>>(new Set());\r\n\r\n  useEffect(() => {\r\n    const fetchData = async () => {\r\n      try {\r\n        const { file } = currentMessage;\r\n        const getFileComplete = file?.filter((item) => item.uri);\r\n        if (!getFileComplete) return;\r\n\r\n        // ✅ Chỉ xử lý những video chưa có thumbnail và chưa được xử lý\r\n        const videosNeedThumbnail = getFileComplete.filter(\r\n          (item) =>\r\n            item.typeFile === 'video' &&\r\n            !item?.thumbnailPreview &&\r\n            !processedFiles.current.has(item.uri)\r\n        );\r\n\r\n        // ✅ Cập nhật loading state cho tất cả video chưa có thumbnail\r\n        const newArrMediaLoading = getFileComplete.map((item) => {\r\n          if (item.typeFile === 'video' && !item?.thumbnailPreview) {\r\n            const isProcessing = videosNeedThumbnail.some(\r\n              (v) => v.uri === item.uri\r\n            );\r\n            return { ...item, isLoading: isProcessing };\r\n          }\r\n          return item;\r\n        });\r\n\r\n        setArrMedia(newArrMediaLoading);\r\n\r\n        // ✅ Chỉ tạo thumbnail cho những video cần thiết\r\n        if (videosNeedThumbnail.length > 0) {\r\n          const result = await generateThumbnails(videosNeedThumbnail);\r\n\r\n          // ✅ Cache thumbnail results\r\n          result.forEach((res, index) => {\r\n            const video = videosNeedThumbnail[index];\r\n            if (video && res.path) {\r\n              thumbnailCache.current.set(video.uri, res.path);\r\n              processedFiles.current.add(video.uri);\r\n            }\r\n          });\r\n        }\r\n\r\n        // ✅ Cập nhật final state với thumbnail từ cache hoặc mới tạo\r\n        const newArrMedia = getFileComplete.map((item) => {\r\n          if (item.typeFile === 'video') {\r\n            const cachedThumbnail = thumbnailCache.current.get(item.uri);\r\n            const thumbnail = item?.thumbnailPreview || cachedThumbnail || '';\r\n            return {\r\n              ...item,\r\n              thumbnailPreview: thumbnail,\r\n              isLoading: false,\r\n            };\r\n          }\r\n          return item;\r\n        });\r\n\r\n        onSaveThumbnail?.(newArrMedia);\r\n        setArrMedia(newArrMedia);\r\n      } catch (error) {\r\n        console.log('error fetchData media', error);\r\n      }\r\n    };\r\n    fetchData();\r\n  }, [currentMessage, onSaveThumbnail]);\r\n\r\n  const arrMediaShow = isShowAll ? arrMedia : arrMedia?.slice(0, 8);\r\n  const size = calcSize(!!isShowAll, messageWidth);\r\n\r\n  return (\r\n    <View onLayout={onLayout} style={[styles.container, { gap: GAP_MEDIA }]}>\r\n      <FlatList\r\n        data={arrMediaShow || []}\r\n        renderItem={({ item, index }) => (\r\n          <MediaItem\r\n            item={item}\r\n            index={index}\r\n            size={size}\r\n            arrMedia={arrMedia}\r\n            isShowAll={!!isShowAll}\r\n            isReaction={isReaction}\r\n            currentMessage={currentMessage}\r\n            onPressFile={onPressFile}\r\n            onLongPressFile={onLongPressFile}\r\n          />\r\n        )}\r\n        keyExtractor={(item) =>\r\n          item?.clientId?.toString() || item?.uri?.toString()\r\n        }\r\n        numColumns={4}\r\n        scrollEnabled={false}\r\n        columnWrapperStyle={{ gap: GAP_MEDIA }}\r\n        initialNumToRender={4}\r\n        maxToRenderPerBatch={4}\r\n        windowSize={5}\r\n        removeClippedSubviews={false} // ✅ tránh flicker\r\n        getItemLayout={(_, index) => ({\r\n          length: size,\r\n          offset: Math.floor(index / 4) * size,\r\n          index,\r\n        })}\r\n      />\r\n    </View>\r\n  );\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flexDirection: 'row',\r\n    marginVertical: 4,\r\n    paddingHorizontal: 4,\r\n    borderRadius: 8,\r\n  },\r\n  mediaItem: {\r\n    borderRadius: 8,\r\n    backgroundColor: 'rgba(0, 0, 0, 0.05)',\r\n    overflow: 'hidden',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    marginBottom: 4,\r\n  },\r\n  playIcon: {\r\n    position: 'absolute',\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n    backgroundColor: 'rgba(255, 255, 255, 0.5)',\r\n  },\r\n  image: {\r\n    width: '100%',\r\n    height: '100%',\r\n  },\r\n  reactionIcon: {\r\n    position: 'absolute',\r\n    backgroundColor: 'rgba(0, 0, 0, 0.5)',\r\n    width: '100%',\r\n    height: '100%',\r\n    borderRadius: 8,\r\n    justifyContent: 'center',\r\n    alignItems: 'center',\r\n  },\r\n  reactionIconText: {\r\n    color: Color.white,\r\n    fontSize: 16,\r\n    fontWeight: '600',\r\n    lineHeight: 22,\r\n  },\r\n  progress: {\r\n    position: 'absolute',\r\n    top: 0,\r\n    left: 0,\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    backgroundColor: 'rgba(0, 0, 0, 0.3)',\r\n  },\r\n});\r\n"],"mappings":"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","ignoreList":[]}