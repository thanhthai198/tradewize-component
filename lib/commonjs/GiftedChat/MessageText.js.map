{"version":3,"names":["_reactNative","require","_reactNativeParsedText","_interopRequireDefault","_GiftedChatContext","_logging","e","__esModule","default","WWW_URL_PATTERN","textStyle","StyleSheet","create","fontSize","lineHeight","marginTop","marginBottom","marginLeft","marginRight","styles","left","container","text","color","link","textDecorationLine","right","DEFAULT_OPTION_TITLES","MessageText","currentMessage","optionTitles","position","containerStyle","linkStyle","linkStyleProp","customTextStyle","parsePatterns","textProps","actionSheet","useChatContext","onUrlPress","url","test","Linking","openURL","catch","error","onPhonePress","phone","options","length","slice","cancelButtonIndex","showActionSheetWithOptions","buttonIndex","onEmailPress","email","React","createElement","View","style","parse","type","onPress","childrenProps"],"sources":["MessageText.tsx"],"sourcesContent":["import {\n  Linking,\n  StyleSheet,\n  View,\n  type TextProps,\n  type StyleProp,\n  type ViewStyle,\n  type TextStyle,\n} from 'react-native';\n\nimport ParsedText from 'react-native-parsed-text';\nimport { type LeftRightStyle, type IMessage } from './types';\nimport { useChatContext } from './GiftedChatContext';\nimport { error } from './logging';\n\nconst WWW_URL_PATTERN = /^www\\./i;\n\nconst { textStyle } = StyleSheet.create({\n  textStyle: {\n    fontSize: 16,\n    lineHeight: 20,\n    marginTop: 5,\n    marginBottom: 5,\n    marginLeft: 10,\n    marginRight: 10,\n  },\n});\n\nconst styles = {\n  left: StyleSheet.create({\n    container: {},\n    text: {\n      color: 'black',\n      ...textStyle,\n    },\n    link: {\n      color: 'black',\n      textDecorationLine: 'underline',\n    },\n  }),\n  right: StyleSheet.create({\n    container: {},\n    text: {\n      color: 'white',\n      ...textStyle,\n    },\n    link: {\n      color: 'white',\n      textDecorationLine: 'underline',\n    },\n  }),\n};\n\nconst DEFAULT_OPTION_TITLES = ['Call', 'Text', 'Cancel'];\n\nexport interface MessageTextProps<TMessage extends IMessage> {\n  position?: 'left' | 'right';\n  optionTitles?: string[];\n  currentMessage: TMessage;\n  containerStyle?: LeftRightStyle<ViewStyle>;\n  textStyle?: LeftRightStyle<TextStyle>;\n  linkStyle?: LeftRightStyle<TextStyle>;\n  textProps?: TextProps;\n  customTextStyle?: StyleProp<TextStyle>;\n  parsePatterns?: (linkStyle: TextStyle) => [];\n}\n\nexport function MessageText<TMessage extends IMessage = IMessage>({\n  currentMessage = {} as TMessage,\n  optionTitles = DEFAULT_OPTION_TITLES,\n  position = 'left',\n  containerStyle,\n  textStyle,\n  linkStyle: linkStyleProp,\n  customTextStyle,\n  parsePatterns,\n  textProps,\n}: MessageTextProps<TMessage>) {\n  const { actionSheet } = useChatContext();\n\n  // TODO: React.memo\n  // const shouldComponentUpdate = (nextProps: MessageTextProps<TMessage>) => {\n  //   return (\n  //     !!currentMessage &&\n  //     !!nextProps.currentMessage &&\n  //     currentMessage.text !== nextProps.currentMessage.text\n  //   )\n  // }\n\n  const onUrlPress = (url: string) => {\n    // When someone sends a message that includes a website address beginning with \"www.\" (omitting the scheme),\n    // react-native-parsed-text recognizes it as a valid url, but Linking fails to open due to the missing scheme.\n    if (WWW_URL_PATTERN.test(url)) onUrlPress(`https://${url}`);\n    else\n      Linking.openURL(url).catch((e) => {\n        error(e, 'No handler for URL:', url);\n      });\n  };\n\n  const onPhonePress = (phone: string) => {\n    const options =\n      optionTitles && optionTitles.length > 0\n        ? optionTitles.slice(0, 3)\n        : DEFAULT_OPTION_TITLES;\n    const cancelButtonIndex = options.length - 1;\n    actionSheet().showActionSheetWithOptions(\n      {\n        options,\n        cancelButtonIndex,\n      },\n      (buttonIndex?: number) => {\n        switch (buttonIndex) {\n          case 0:\n            Linking.openURL(`tel:${phone}`).catch((e) => {\n              error(e, 'No handler for telephone');\n            });\n            break;\n          case 1:\n            Linking.openURL(`sms:${phone}`).catch((e) => {\n              error(e, 'No handler for text');\n            });\n            break;\n        }\n      }\n    );\n  };\n\n  const onEmailPress = (email: string) =>\n    Linking.openURL(`mailto:${email}`).catch((e) =>\n      error(e, 'No handler for mailto')\n    );\n\n  const linkStyle = [styles[position].link, linkStyleProp?.[position]];\n  return (\n    <View style={[styles[position].container, containerStyle?.[position]]}>\n      <ParsedText\n        style={[styles[position].text, textStyle?.[position], customTextStyle]}\n        parse={[\n          ...(parsePatterns\n            ? parsePatterns(linkStyle as unknown as TextStyle)\n            : []),\n          { type: 'url', style: linkStyle, onPress: onUrlPress },\n          { type: 'phone', style: linkStyle, onPress: onPhonePress },\n          { type: 'email', style: linkStyle, onPress: onEmailPress },\n        ]}\n        childrenProps={{ ...textProps }}\n      >\n        {currentMessage!.text}\n      </ParsedText>\n    </View>\n  );\n}\n"],"mappings":"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","ignoreList":[]}